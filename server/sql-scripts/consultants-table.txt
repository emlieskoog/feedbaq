DROP TABLE consultants;

CREATE TABLE consultants (
    id SERIAL PRIMARY KEY,
    first_name VARCHAR(25),
    last_name VARCHAR(25),
    manager_id INT,
    created_at TIMESTAMP DEFAULT current_timestamp,
    updated_at TIMESTAMP DEFAULT current_timestamp
);

CREATE FUNCTION update_timestamp()
RETURNS TRIGGER AS '
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END' LANGUAGE 'plpgsql';

CREATE TRIGGER update_trigger
BEFORE UPDATE ON consultants
FOR EACH ROW
EXECUTE PROCEDURE update_timestamp();

INSERT INTO consultants (first_name, last_name, manager_id) VALUES ('Agnes', 'Davidsdottir', 1);
INSERT INTO consultants (first_name, last_name, manager_id) VALUES ('Emelie', 'Skoog', 2);
INSERT INTO consultants (first_name, last_name, manager_id) VALUES ('Wilma', 'Axelsson', 3);
INSERT INTO consultants (first_name, last_name, manager_id) VALUES ('Lucas', 'Hultqvist', 4);
INSERT INTO consultants (first_name, last_name, manager_id) VALUES ('Anders', 'Lundkvist', 5);

SELECT * FROM consultants;
