DROP TABLE forms;

CREATE TABLE forms (
    id SERIAL PRIMARY KEY,
    consultant_id INTEGER,
    customer_id INTEGER,
    sales_id INTEGER,
    form_response_id INTEGER,
    date DATE,
    form_response_id INTEGER,
    FOREIGN KEY (form_response_id) REFERENCES form_responses(id) ON DELETE CASCADE,
    created_at TIMESTAMP DEFAULT current_timestamp,
    updated_at TIMESTAMP DEFAULT current_timestamp
);

CREATE FUNCTION update_timestamp()
RETURNS TRIGGER AS '
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END' LANGUAGE 'plpgsql';

CREATE TRIGGER update_trigger
BEFORE UPDATE ON forms
FOR EACH ROW
EXECUTE PROCEDURE update_timestamp();

INSERT INTO forms (consultant_id, customer_id, sales_id, date, form_response_id) VALUES (1, 1, 3, '2023-09-21', 1);
INSERT INTO forms (consultant_id, customer_id, sales_id, date, form_response_id) VALUES (2, 3, 2, '2023-09-21', 2);
INSERT INTO forms (consultant_id, customer_id, sales_id, date, form_response_id) VALUES (4, 4, 4, '2023-09-21', 3);
INSERT INTO forms (consultant_id, customer_id, sales_id, date, form_response_id) VALUES (3, 2, 1, '2023-09-21', 4);

SELECT * FROM forms;